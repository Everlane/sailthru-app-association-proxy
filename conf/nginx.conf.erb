daemon off;
worker_processes 4;

events {
	worker_connections 1024;
}

http {
  server_tokens off;

	client_body_timeout 5;

  server {
      listen 80;

      # SSL Configuration
      listen 443;
      ssl    on;
      ssl_certificate    /etc/ssl/your_domain_name.pem;
      ssl_certificate_key    /etc/ssl/your_domain_name.key;

      <% (19000..20000).each do |unsubscribe_port| %>
        listen <%= unsubscribe_port %>;
      <% end %>

      proxy_ssl_session_reuse off;

      location /apple-app-site-association {
          proxy_pass <%= ENV['APP_ASSOCIATION_HOST'] %>;
      }

      location = / {
          proxy_pass <%= ENV['APP_ASSOCIATION_HOST'] %>;
      }

      location / {
          proxy_pass http://cb.sailthru.com;
      }
  }
}
